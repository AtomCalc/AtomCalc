<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>4. Motional state system &mdash; AtomCalc  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/nbsphinx-code-cells.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="&lt;no title&gt;" href="../modules.html" />
    <link rel="prev" title="3. Conveniently shifting the first level" href="Example3.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            AtomCalc
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Tutorials:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Example1.html">1. Simulating a Raman transition with constant lasers</a></li>
<li class="toctree-l1"><a class="reference internal" href="Example2.html">2. Simulating a Raman transition with laser pulses</a></li>
<li class="toctree-l1"><a class="reference internal" href="Example3.html">3. Conveniently shifting the first level</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">4. Motional state system</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Classes and Functions:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../modules.html"><code class="docutils literal notranslate"><span class="pre">Decay</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html#atomcalc.Laser"><code class="docutils literal notranslate"><span class="pre">Laser</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html#atomcalc.Level"><code class="docutils literal notranslate"><span class="pre">Level</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html#atomcalc.plot_pulse"><code class="docutils literal notranslate"><span class="pre">plot_pulse()</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html#atomcalc.System"><code class="docutils literal notranslate"><span class="pre">System</span></code></a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">AtomCalc</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active"><span class="section-number">4. </span>Motional state system</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/notebooks/Example4.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Motional-state-system">
<h1><span class="section-number">4. </span>Motional state system<a class="headerlink" href="#Motional-state-system" title="Permalink to this heading">ÔÉÅ</a></h1>
<div class="line-block">
<div class="line">Here, we want to show how a system with motional states can be simulated with AtomCalc. There are no motional state specific modules in the package. This is just an additional example of what can be done.</div>
<div class="line">We simulate a two-level system where we add one motional state to each level.</div>
<div class="line">We assume a harmonic potential that leads to the splitting of the motional states and describe the transitions with Franck-Condon coefficients.</div>
<div class="line">For all the background theory see my master thesis.</div>
<div class="line">This tutorial does not use realistic values. It rather is supposed to be a step by step guide of how a simulation with motional states can be done.</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">atomcalc</span> <span class="kn">import</span> <span class="n">Level</span><span class="p">,</span> <span class="n">Laser</span><span class="p">,</span> <span class="n">Decay</span><span class="p">,</span> <span class="n">System</span><span class="p">,</span> <span class="n">plot_pulse</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">constants</span>
<span class="kn">import</span> <span class="nn">math</span>
</pre></div>
</div>
</div>
<div class="line-block">
<div class="line">For the calculation of the Franck-Condon coefficients we define a few functions.</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">make_Hr</span></code> returns the Hermite polynomials that are needed for the calculation of the harmonic wavefunctions.</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">get_psi</span></code> calculates those wavefunctions.</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">FC_coefficient</span></code> calculates the Franck-Condon coefficient for a transition between sublevel <code class="docutils literal notranslate"><span class="pre">v1</span></code> of the cluster with trap (angular) frequency <code class="docutils literal notranslate"><span class="pre">omega1</span></code> and the sublevel <code class="docutils literal notranslate"><span class="pre">v2</span></code> of the cluster with trap (angular) frequency <code class="docutils literal notranslate"><span class="pre">omega2</span></code>.</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">m</span></code> is the mass of the atom and <code class="docutils literal notranslate"><span class="pre">k</span></code> the wavevector of the laser that couples the two sublevels (if there is no laser <code class="docutils literal notranslate"><span class="pre">k</span></code> is zero).</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">make_Hr</span><span class="p">(</span><span class="n">max_v</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a list of np.poly1d objects representing Hermite polynomials.&quot;&quot;&quot;</span>
    <span class="n">Hr</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">max_v</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">Hr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">([</span><span class="mf">1.</span><span class="p">,])</span>
    <span class="n">Hr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">([</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">max_v</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">Hr</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">Hr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">Hr</span><span class="p">[</span><span class="n">v</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">v</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">Hr</span><span class="p">[</span><span class="n">v</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">Hr</span>

<span class="k">def</span> <span class="nf">get_psi</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the harmonic oscillator wavefunction for level v.&quot;&quot;&quot;</span>
    <span class="n">Hr</span> <span class="o">=</span> <span class="n">make_Hr</span><span class="p">(</span><span class="n">v</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">factor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">omega</span><span class="o">/</span><span class="n">scipy</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">hbar</span><span class="p">)</span>
    <span class="n">N</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">omega</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">scipy</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">hbar</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">v</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">N</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">*</span><span class="n">Hr</span><span class="p">[</span><span class="n">v</span><span class="p">](</span><span class="n">factor</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">factor</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">FC_coefficient</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">omega1</span><span class="p">,</span> <span class="n">omega2</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">x_list</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the Franck-Condon coefficient between sublevels v1 and v2.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">get_psi</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">omega1</span><span class="p">,</span> <span class="n">x_list</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">x_list</span><span class="p">)</span><span class="o">*</span><span class="n">get_psi</span><span class="p">(</span><span class="n">v2</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">omega2</span><span class="p">,</span> <span class="n">x_list</span><span class="p">),</span> <span class="n">x_list</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>Next, let us define the trap frequencies, the mass of the atom, and the motional levels:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">omega_1</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># as angular frequency</span>
<span class="n">omega_2</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="n">m</span> <span class="o">=</span> <span class="mf">1e-25</span> <span class="c1"># in kg</span>

<span class="c1"># define level objects according to the energy separation of the quantum harmonic oscillator</span>
<span class="n">level1_1</span> <span class="o">=</span> <span class="n">Level</span><span class="p">(</span><span class="mi">0</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">omega_1</span><span class="p">)</span> <span class="c1"># first sublevel of level 1</span>
<span class="n">level1_2</span> <span class="o">=</span> <span class="n">Level</span><span class="p">(</span><span class="mi">0</span> <span class="o">+</span> <span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">omega_1</span><span class="p">)</span> <span class="c1"># second sublevel of level 1</span>
<span class="n">level2_1</span> <span class="o">=</span> <span class="n">Level</span><span class="p">(</span><span class="mi">100</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">omega_2</span><span class="p">)</span>
<span class="n">level2_2</span> <span class="o">=</span> <span class="n">Level</span><span class="p">(</span><span class="mi">100</span> <span class="o">+</span> <span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">omega_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>With that we can calculate the Franck-Condon coefficients:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define laser properties</span>
<span class="n">frequency_of_the_laser</span> <span class="o">=</span> <span class="p">(</span><span class="n">level2_1</span><span class="o">.</span><span class="n">energy</span> <span class="o">-</span> <span class="n">level1_1</span><span class="o">.</span><span class="n">energy</span><span class="p">)</span> <span class="c1"># angular frequency of the laser without detuning</span>
<span class="n">Delta</span> <span class="o">=</span> <span class="mi">5</span> <span class="c1"># detuning of the laser defined as angular frequency</span>
<span class="n">Omega</span> <span class="o">=</span> <span class="mi">100</span> <span class="c1"># Rabi frequency of the laser as angular frequency</span>
<span class="n">k</span> <span class="o">=</span> <span class="p">(</span><span class="n">frequency_of_the_laser</span> <span class="o">+</span> <span class="n">Delta</span><span class="p">)</span><span class="o">/</span><span class="n">scipy</span><span class="o">.</span><span class="n">constants</span><span class="o">.</span><span class="n">c</span> <span class="c1"># wavevector of the laser</span>

<span class="c1"># calculate Franck-Condon coefficients</span>
<span class="n">x_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">1.2e-4</span><span class="p">,</span><span class="mf">1.2e-4</span><span class="p">,</span><span class="mi">200000</span><span class="p">)</span> <span class="c1"># define the interval to calculate the definite integral</span>
<span class="n">FC11_21</span> <span class="o">=</span> <span class="n">FC_coefficient</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">omega_1</span><span class="p">,</span> <span class="n">omega_2</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">x_list</span><span class="p">)</span> <span class="c1"># between level1_1 and level2_1</span>
<span class="n">FC11_22</span> <span class="o">=</span> <span class="n">FC_coefficient</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">omega_1</span><span class="p">,</span> <span class="n">omega_2</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">x_list</span><span class="p">)</span> <span class="c1"># between level1_1 and level2_2</span>
<span class="n">FC12_21</span> <span class="o">=</span> <span class="n">FC_coefficient</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">omega_1</span><span class="p">,</span> <span class="n">omega_2</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">x_list</span><span class="p">)</span> <span class="c1"># between level1_2 and level2_1</span>
<span class="n">FC12_22</span> <span class="o">=</span> <span class="n">FC_coefficient</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">omega_1</span><span class="p">,</span> <span class="n">omega_2</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">x_list</span><span class="p">)</span> <span class="c1"># between level1_2 and level2_2</span>
</pre></div>
</div>
</div>
<p>The decay channels depend on the Franck-Condon coefficients. Here, every decay rate without the consideration of Franck-Condon coefficients is (arbitrarily) chosen to be one.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">decay</span> <span class="o">=</span> <span class="n">Decay</span><span class="p">([</span><span class="mi">1</span><span class="o">*</span><span class="n">FC11_21</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">*</span><span class="n">FC11_22</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">*</span><span class="n">FC12_21</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">*</span><span class="n">FC12_22</span><span class="o">**</span><span class="mi">2</span><span class="p">],</span>\
              <span class="p">[[</span><span class="n">level2_1</span><span class="p">,</span><span class="n">level1_1</span><span class="p">],[</span><span class="n">level2_2</span><span class="p">,</span><span class="n">level1_1</span><span class="p">],[</span><span class="n">level2_1</span><span class="p">,</span><span class="n">level1_2</span><span class="p">],[</span><span class="n">level2_2</span><span class="p">,</span><span class="n">level1_2</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="line-block">
<div class="line">The next code block is just an insertion to visualize the wavefunctions and see that the borders of the definite integral make sense. Two wavefunctions are plotted inside the given borders.</div>
<div class="line">Additionally, the Franck-Condon coefficients are printed.</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pylab</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">x_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">1.2e-4</span><span class="p">,</span><span class="mf">1.2e-4</span><span class="p">,</span><span class="mi">200000</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_list</span><span class="p">,</span> <span class="n">get_psi</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1e-25</span><span class="p">,</span> <span class="n">omega_1</span><span class="p">,</span> <span class="n">x_list</span><span class="p">))</span> <span class="c1">#/41341373</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_list</span><span class="p">,</span> <span class="n">get_psi</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1e-25</span><span class="p">,</span> <span class="n">omega_2</span><span class="p">,</span> <span class="n">x_list</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;pos&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;psi amplitude&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">FC11_21</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">FC11_22</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">FC12_21</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">FC12_22</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Example4_11_0.png" src="../_images/notebooks_Example4_11_0.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.9898463956837853
7.818578997749391e-12
6.383843019374053e-12
0.9698472624862684
</pre></div></div>
</div>
<div class="line-block">
<div class="line">Although there is just one laser, we need to define a laser object for every possible transition, where the <code class="docutils literal notranslate"><span class="pre">couple</span></code> argument is different.</div>
<div class="line">The Rabi frequency of each transition is influenced by the corresponding Franck-Condon factor.</div>
<div class="line">Also, the detunings must be chosen so that every laser has exactly the same frequency (because they all represent the same laser, just for different transitions).</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">laser11_21</span> <span class="o">=</span> <span class="n">Laser</span><span class="p">(</span><span class="n">Omega</span><span class="o">*</span><span class="n">FC11_21</span><span class="p">,</span> <span class="n">Delta</span><span class="p">,</span> <span class="p">[</span><span class="n">level1_1</span><span class="p">,</span><span class="n">level2_1</span><span class="p">])</span>
<span class="n">laser11_22</span> <span class="o">=</span> <span class="n">Laser</span><span class="p">(</span><span class="n">Omega</span><span class="o">*</span><span class="n">FC11_22</span><span class="p">,</span> <span class="n">Delta</span> <span class="o">-</span> <span class="n">omega_2</span><span class="p">,</span> <span class="p">[</span><span class="n">level1_1</span><span class="p">,</span><span class="n">level2_2</span><span class="p">])</span>
<span class="n">laser12_21</span> <span class="o">=</span> <span class="n">Laser</span><span class="p">(</span><span class="n">Omega</span><span class="o">*</span><span class="n">FC12_21</span><span class="p">,</span> <span class="n">Delta</span> <span class="o">+</span> <span class="n">omega_1</span><span class="p">,</span> <span class="p">[</span><span class="n">level1_2</span><span class="p">,</span><span class="n">level2_1</span><span class="p">])</span>
<span class="n">laser12_22</span> <span class="o">=</span> <span class="n">Laser</span><span class="p">(</span><span class="n">Omega</span><span class="o">*</span><span class="n">FC12_22</span><span class="p">,</span> <span class="n">Delta</span> <span class="o">+</span> <span class="n">omega_1</span> <span class="o">-</span> <span class="n">omega_2</span><span class="p">,</span> <span class="p">[</span><span class="n">level1_2</span><span class="p">,</span><span class="n">level2_2</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">laser11_21</span><span class="o">.</span><span class="n">frequency</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">laser11_22</span><span class="o">.</span><span class="n">frequency</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">laser12_21</span><span class="o">.</span><span class="n">frequency</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">laser12_22</span><span class="o">.</span><span class="n">frequency</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">frequency_of_the_laser</span> <span class="o">+</span> <span class="n">Delta</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
105.25
105.25
105.25
105.25
105.25
</pre></div></div>
</div>
<p>Now we are ready to define the system object and draw the system sketch.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># define system (sort levels by energy in ascending order.)</span>
<span class="n">system</span> <span class="o">=</span> <span class="n">System</span><span class="p">([</span><span class="n">level1_1</span><span class="p">,</span><span class="n">level1_2</span><span class="p">,</span><span class="n">level2_1</span><span class="p">,</span><span class="n">level2_2</span><span class="p">],</span>\
                 <span class="p">[</span><span class="n">laser11_21</span><span class="p">,</span><span class="n">laser11_22</span><span class="p">,</span><span class="n">laser12_21</span><span class="p">,</span><span class="n">laser12_22</span><span class="p">],</span> <span class="n">decay</span><span class="p">)</span>

<span class="c1"># draw the system in matplotlib</span>
<span class="n">system</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Example4_15_0.png" src="../_images/notebooks_Example4_15_0.png" />
</div>
</div>
<p>Now we can simulate the system. We can choose the starting population with the <code class="docutils literal notranslate"><span class="pre">initial_state_index_list</span></code>. We choose [0.6,0.4,0,0] which means 60% are in the first level, 40% are in the second level, and 0% are in the third and forth level at the start of the simulation.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># simulate the system</span>
<span class="n">system</span><span class="o">.</span><span class="n">simulate</span><span class="p">([</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Hamiltonian in the rotating frame: Quantum object: dims = [[4], [4]], shape = (4, 4), type = oper, isherm = True
Qobj data =
[[-5.00000000e-01  0.00000000e+00  4.94923198e+01  3.90928950e-10]
 [ 0.00000000e+00 -1.50000000e+00  3.19192151e-10  4.84923631e+01]
 [ 4.94923198e+01  3.19192151e-10  4.50000000e+00  0.00000000e+00]
 [ 3.90928950e-10  4.84923631e+01  0.00000000e+00  3.00000000e+00]]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Example4_17_1.png" src="../_images/notebooks_Example4_17_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Maximum population of level 3:
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.5912821470183767
</pre></div></div>
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Example3.html" class="btn btn-neutral float-left" title="3. Conveniently shifting the first level" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../modules.html" class="btn btn-neutral float-right" title="&lt;no title&gt;" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Moritz Wilke.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>