<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>2. Simulating a Raman transition with laser pulses &mdash; AtomCalc  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/nbsphinx-code-cells.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="3. Conveniently shifting the first level" href="Example3.html" />
    <link rel="prev" title="1. Simulating a Raman transition with constant lasers" href="Example1.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            AtomCalc
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Tutorials:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Example1.html">1. Simulating a Raman transition with constant lasers</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">2. Simulating a Raman transition with laser pulses</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Trotter-decomposition-(excerpt-of-my-master-thesis)">2.1. Trotter decomposition (excerpt of my master thesis)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Example3.html">3. Conveniently shifting the first level</a></li>
<li class="toctree-l1"><a class="reference internal" href="Example4.html">4. Motional state system</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Classes and Functions:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../modules.html"><code class="docutils literal notranslate"><span class="pre">Decay</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html#atomcalc.Laser"><code class="docutils literal notranslate"><span class="pre">Laser</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html#atomcalc.Level"><code class="docutils literal notranslate"><span class="pre">Level</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html#atomcalc.plot_pulse"><code class="docutils literal notranslate"><span class="pre">plot_pulse()</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html#atomcalc.System"><code class="docutils literal notranslate"><span class="pre">System</span></code></a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">AtomCalc</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active"><span class="section-number">2. </span>Simulating a Raman transition with laser pulses</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/notebooks/Example2.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Simulating-a-Raman-transition-with-laser-pulses">
<h1><span class="section-number">2. </span>Simulating a Raman transition with laser pulses<a class="headerlink" href="#Simulating-a-Raman-transition-with-laser-pulses" title="Permalink to this heading"></a></h1>
<div class="line-block">
<div class="line">This tutorial builds on the first tutorial.</div>
<div class="line">We simulate the same system as in the first tutorial but with a time-dependent Rabi frequency of both lasers.</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">atomcalc</span> <span class="kn">import</span> <span class="n">Level</span><span class="p">,</span> <span class="n">Laser</span><span class="p">,</span> <span class="n">Decay</span><span class="p">,</span> <span class="n">System</span><span class="p">,</span> <span class="n">plot_pulse</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
<p>We use the same parameters as in the first tutorial.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># define level objects</span>
<span class="n">level1</span> <span class="o">=</span> <span class="n">Level</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">level2</span> <span class="o">=</span> <span class="n">Level</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="n">level3</span> <span class="o">=</span> <span class="n">Level</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>

<span class="c1"># define decay object</span>
<span class="n">decay</span> <span class="o">=</span> <span class="n">Decay</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[[</span><span class="n">level3</span><span class="p">,</span><span class="n">level1</span><span class="p">],[</span><span class="n">level3</span><span class="p">,</span><span class="n">level2</span><span class="p">]])</span> <span class="c1"># no decay</span>

<span class="c1"># define parameters</span>
<span class="n">Delta</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">delta</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">Omega1</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">Omega2</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="line-block">
<div class="line">We define the pulses as functions depending on t. Here, we define gaussian pulses.</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">plot_pulse</span></code> is just a little function to draw the pulse with matplotlib.</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">pulse_1</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">Omega1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">((</span><span class="n">t</span> <span class="o">-</span> <span class="mi">150</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">50</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">pulse_2</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">Omega2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">((</span><span class="n">t</span> <span class="o">-</span> <span class="mi">150</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">50</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">plot_pulse</span><span class="p">(</span><span class="n">pulse_1</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Example2_5_0.png" src="../_images/notebooks_Example2_5_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># System</span>
<span class="n">laser1</span> <span class="o">=</span> <span class="n">Laser</span><span class="p">(</span><span class="n">Omega1</span><span class="p">,</span> <span class="n">Delta</span><span class="p">,</span> <span class="p">[</span><span class="n">level1</span><span class="p">,</span> <span class="n">level3</span><span class="p">],</span> <span class="n">pulse</span><span class="o">=</span><span class="n">pulse_1</span><span class="p">)</span>
<span class="n">laser2</span> <span class="o">=</span> <span class="n">Laser</span><span class="p">(</span><span class="n">Omega2</span><span class="p">,</span> <span class="n">Delta</span> <span class="o">-</span> <span class="n">delta</span><span class="p">,</span> <span class="p">[</span><span class="n">level2</span><span class="p">,</span> <span class="n">level3</span><span class="p">],</span> <span class="n">pulse</span><span class="o">=</span><span class="n">pulse_2</span><span class="p">)</span>
<span class="n">system</span> <span class="o">=</span> <span class="n">System</span><span class="p">([</span><span class="n">level1</span><span class="p">,</span> <span class="n">level2</span><span class="p">,</span> <span class="n">level3</span><span class="p">],</span> <span class="p">[</span><span class="n">laser1</span><span class="p">,</span> <span class="n">laser2</span><span class="p">],</span> <span class="n">decay</span><span class="p">)</span>
<span class="n">system</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Example2_6_0.png" src="../_images/notebooks_Example2_6_0.png" />
</div>
</div>
<div class="line-block">
<div class="line">The Trotter intervals determine how the pulse is discretized. In my master thesis this is explained in detail in the method and the appendix section. An excerpt is shown following this tutorial</div>
<div class="line">A Trotter interval is a time interval in which the pulse is assumed to be constant.</div>
<div class="line">A Trotter step is the distance in time where the population of the levels is calculated.</div>
<div class="line">In this example we calculate the population for every 3 time units and the pulse is assumed to be constant over time intervals of 6 time units.</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># calculate and show the time evolution</span>
<span class="n">system</span><span class="o">.</span><span class="n">simulate</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">,</span><span class="mi">300</span><span class="p">,</span><span class="n">Diagonalization</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">Trotterintervals</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="n">points_per_TI</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Hamiltonian in the rotating frame: [[ 0.+0.j  0.+0.j  0.+0.j]
 [ 0.+0.j  0.+0.j  0.+0.j]
 [ 0.+0.j  0.+0.j 20.+0.j]]
One trotterinterval has size 6.0.
One trotter step has size 3.0.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Example2_8_1.png" src="../_images/notebooks_Example2_8_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Maximum population of level 2:
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.7997789543219783
</pre></div></div>
</div>
<section id="Trotter-decomposition-(excerpt-of-my-master-thesis)">
<h2><span class="section-number">2.1. </span>Trotter decomposition (excerpt of my master thesis)<a class="headerlink" href="#Trotter-decomposition-(excerpt-of-my-master-thesis)" title="Permalink to this heading"></a></h2>
<p><img alt="f5298a06040140b383be374f65229d95" class="no-scaled-link" src="../_images/Trotterdecomposition.PNG" style="width: 600px;" /></p>
<p>This Figure shows the Trotter decomposition of a timeline and visualizes the parameters of the sourcecode. The illustration is done with <code class="docutils literal notranslate"><span class="pre">number_TI</span> <span class="pre">=</span> <span class="pre">5</span></code> and <code class="docutils literal notranslate"><span class="pre">points_per_TI</span> <span class="pre">=</span> <span class="pre">2</span></code>. The time discretization <code class="docutils literal notranslate"><span class="pre">td</span></code> defines the Trotter intervals where the respective Liouvillian <code class="docutils literal notranslate"><span class="pre">L[n]</span></code> is constant. The <code class="docutils literal notranslate"><span class="pre">trotter_step</span></code> defines the points in time where the density matrix is calculated.</p>
<p>For every Trotter interval the respective Liouvillian is constant and for every <code class="docutils literal notranslate"><span class="pre">trotter_step</span></code> a density matrix is calculated. There are two conditions for the code to work: The number of Trotter intervals <code class="docutils literal notranslate"><span class="pre">number_TI</span></code> must be chosen so that the Trotter intervals have integer time. Additionally, <code class="docutils literal notranslate"><span class="pre">points_per_TI</span></code> must be chosen so that <code class="docutils literal notranslate"><span class="pre">trotter_step</span></code> is integer. Together that means <span class="math notranslate nohighlight">\(\frac{\texttt{maxtime}}{\texttt{number\_TI}\cdot \texttt{points\_per\_TI}}\)</span> has to be an integer. In
the illustrated example this would be fulfilled for <code class="docutils literal notranslate"><span class="pre">maxtime</span> <span class="pre">=</span> <span class="pre">10</span></code>, for example.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Example1.html" class="btn btn-neutral float-left" title="1. Simulating a Raman transition with constant lasers" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Example3.html" class="btn btn-neutral float-right" title="3. Conveniently shifting the first level" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Moritz Wilke.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>